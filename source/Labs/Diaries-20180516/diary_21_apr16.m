%-- 16/04/2018 09:30 --%
randcauchy(10,1)
randcauchy(10)
format long
format longG
randcauchy(10)
r=rand(10,1);
x=tan(pi*(r-1/2))
x=randcauchy(1e5);
histogram(x)
max(x)
x=tan(pi*(rand(1e5,1)-1/2));
max(x)
min(x)
x=randcauchy(1e5,[-10,10]);
histogram(x)
x=randcauchy(1e5,[-40,40]);
histogram(x)
x=randcauchy(1e5,[-10,10],@(x)exp(-x.^2/2));
histogram(x)
x=randcauchy(1e6,[-10,10],@(x)exp(-x.^2/2));
histogram(x)
[x,R]=randcauchy(1e6,[-10,10],@(x)exp(-x.^2/2));
R
[x,R]=randcauchy(1e6,[-10,10],@(x)exp(-x.^2/2-0.1*x.^4));
R
histogram(x)
[x,R]=randcauchy(1e6,[-10,10],@(x)exp(+x.^2/2-0.1*x.^4));
R
histogram(x)
c=histcounts(x);
hol
hold
fplot(@(x)max(c)*exp(+x.^2/2-0.1*x.^4-1/16/0.1))
[x,R]=randcauchy(1e6,[-10,10],@(x)exp(+x.^2/2-0.1*x.^4),exp(1/16/0.1));
histogram(x)
f=@(x)exp(+x.^2/2-0.1*x.^4)/(1+x.^2)
f=@(x)exp(+x.^2/2-0.1*x.^4)*(1+x.^2)
fminbnd(f,[0,10])
fminbnd(f,0,10)
f=@(x)-exp(+x.^2/2-0.1*x.^4)*(1+x.^2)
fminbnd(f,0,10)
syms z
f(z)=exp(z^2-0.1*z^4)*(1+z^2)
clear f
f(z)=exp(z^2-0.1*z^4)*(1+z^2)
df=diff(f)
solve(df==0)
double(ans)
f(z)=exp(z^2/2-0.1*z^4)*(1+z^2)
df=diff(f)
solve(df==0)
double(ans)
[x,R]=randcauchy(1e5,[-40,40],@(x)exp(+x.^2/2-0.1*x.^4),pi*1.894585);
histogram(x)
solve(df==0)
double(f(ans))
[x,R]=randcauchy(1e5,[-40,40],@(x)exp(+x.^2/2-0.1*x.^4),pi*ans(3));
histogram(x)
hold
histogram(x)
c=histcounts(x);
hold
fplot(@(x)max(c)*exp(+x.^2/2-0.1*x.^4-1/16/0.1))
R
p.pdf=@(x)exp(+x.^2/2-0.1*x.^4)
p.x0=0;
p.sigma=1;
tic;x=metropolis(1e4,p);toc
p.f=@(x)exp(+x.^2/2-0.1*x.^4)
tic;x=metropolis(1e4,p);toc
p.start=0;
tic;x=metropolis(1e4,p);toc
tic;x=metropolis(1e5,p);toc
hold
histogram(x)
tic;x=metropolis(1e6,p);toc
histogram(x)
tic;x=metropolis(1e5,p);toc
histogram(x)
fig
figure
tic;x=metropolis(1e5,p);toc
figure(2)
histogram(x)
clear
p=rand(10,1)
p=p/sum(p)
x=slowrandp(1e5,p);
c=histcounts(x,(0:10)+1/2);
c
c'/1e5
[c'/1e5,p]
tic;x=slowrandp(1e5,p);toc
p=rand(100,1);
tic;x=slowrandp(1e5,p);toc
p=rand(1000,1);
tic;x=slowrandp(1e5,p);toc
p=rand(10000,1);
tic;x=slowrandp(1e5,p);toc
tic;x=slowrandp(1e6,p);toc
c=histcounts(x,(0:10000)+1/2);
norm(c'/1e6-p)
norm(c'/1e6-p,inf)
norm(c'/1e6-p/sum(p))
norm(c'/1e6-p/sum(p),inf)
size(p)
AT=alias(p);
tic;x=slowrandp(1e6,p);toc
tic;x=krand(1e6,AT);toc
AT
size(AT)
AT=alias(p);
size(AT)
[AT.Y,AT.P]=alias(p);
clear AT
[AT.Y,AT.P]=alias(p);
AT
tic;x=krand(1e6,AT);toc
c=histcounts(x,(0:10000)+1/2);
norm(c'/1e6-p/sum(p),inf)